<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>倒计时示例</title>
    <style>
        .send {
            width: 150px;
            height: 30px;
            line-height: 30px;
            margin: 0 auto;
            cursor: pointer;
            background: #65be2e;
            color: #fff;
        }
 
        #send:hover {
            background: green;
        }
        .disabled {
            background: gray;
            color: #fff;
            cursor: default;
            pointer-events: none;
        }
    </style>
    <script type="text/javascript" src="/Public/study/js/jquery-3.1.1.min.js"></script>
    <script>
        var t1;
        var time;
        $(function () {
            $.ajax({
                url: '/index.php/word/review/getTime',
                type: 'post',
                dataType: 'html',
                data: {'time': time},
                async: true,
                success: function (data) {
                    time = data;
                    if (time > 60) {
                        clearInterval(t1);
                        $("#send").removeClass('disabled');
                        $("#send").html('发送');
                        $("#time").html(60);
                    } else {
                        setTime(time);
                    }
                }
            });
            $("#send").on('click', function () {
                $.ajax({
                    url: '/index.php/word/review/getTime',
                    type: 'post',
                    dataType: 'html',
                    async: true,
                    data: {'time': 200},
                    success: function () {
                        var second = 60;
                        setTime(second);
                    }
                });
 
            });
 
            function setTime(second) {
                $("#send").addClass('disabled');
                t1 = setInterval(function () {
                    second--;
                    if (second <= 0) {
                        clearInterval(t1);
                        $("#send").removeClass('disabled');
                        $("#send").html('发送');
                        $("#time").html(second);
                    } else {
                        $("#send").html(second + 's后重试');
                        $("#time").html(second);
                    }
                }, 1000);
            }
        });
    </script>
</head>
<body>
<div style="width: 500px;height: 200px;border: 1px solid #65be2e; margin: 200px auto;text-align: center;">
    <p><span>倒计时：</span><b id="time"></b> <span> s </span></p>
    <p id="send" class="send"></p>
</div>
 
</body>
</html>
